---
import { getCollection } from 'astro:content';
import DocLayout from '@layouts/DocLayout.astro';

export async function getStaticPaths() {
  const projectEntries = await getCollection('projects');
  
  // If no projects exist, return empty array to prevent build errors
  if (projectEntries.length === 0) {
    return [];
  }
  
  return projectEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content, headings } = await entry.render();

// Build actions array
const actions = [];
if (entry.data.projectUrl) {
  actions.push({
    label: 'View Live Project',
    href: entry.data.projectUrl,
    variant: 'primary' as const,
    icon: 'external' as const,
  });
}
if (entry.data.githubUrl) {
  actions.push({
    label: 'View on GitHub',
    href: entry.data.githubUrl,
    variant: 'secondary' as const,
    icon: 'github' as const,
  });
}
---

<DocLayout
  title={entry.data.title}
  description={entry.data.description}
  headings={headings}
  breadcrumb={{ label: 'Projects', href: '/projects' }}
  backLink={{ label: 'Back to Projects', href: '/projects' }}
  tags={entry.data.tags}
  {...(entry.data.image ? { image: entry.data.image } : {})}
  {...(actions.length > 0 ? { actions } : {})}
  meta={[
    { label: 'Category', value: entry.data.category.charAt(0).toUpperCase() + entry.data.category.slice(1), icon: 'ðŸ“' },
  ]}
>
  <Content />
</DocLayout>
