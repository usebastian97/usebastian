---
import EmptyState from '@components/ui/EmptyState.astro';
import { getCollection } from 'astro:content';
import { useTranslations } from '@i18n/utils';

const t = useTranslations('en');

const allProjects = await getCollection('projects');

const projects = allProjects.sort((a, b) => a.data.order - b.data.order);
---

{projects.length === 0 ? (
  <EmptyState
    icon="ðŸš€"
    title="No projects yet"
    description="We're building something awesome! Stay tuned for exciting projects coming soon."
    actionText="View Blog"
    actionUrl="/blog"
  />
) : (
  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3" id="projects-grid">
    {projects.map((project) => (
      <div class="project-card group relative flex flex-col rounded-lg border-4 border-gray-200 bg-white p-6 shadow-sm transition-all duration-200 hover:shadow-lg dark:bg-gray-800" data-category={project.data.category}>
        <!-- Project Image -->
        {project.data.image && (
          <div class="mb-4 -mx-6 -mt-6 overflow-hidden rounded-t-md">
            <img
              src={project.data.image}
              alt={project.data.title}
              class="aspect-video w-full object-cover transition-transform duration-300 group-hover:scale-105"
              loading="lazy"
            />
          </div>
        )}

        <!-- Category Badge -->
        <div class="mb-3">
          <span class="inline-block rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-gray-800 dark:bg-gray-700 dark:text-gray-200">
            {project.data.category}
          </span>
        </div>

        <!-- Title -->
        <h3 class="mb-3 text-lg font-bold text-gray-900 dark:text-white">
          <a href={`/projects/${project.slug}`} class="after:absolute after:inset-0 hover:text-blue-600 dark:hover:text-blue-400 transition-colors" aria-label={project.data.title}>
            {project.data.title}
          </a>
        </h3>

        <!-- Description -->
        <p class="mb-4 flex-grow text-sm leading-relaxed text-gray-600 dark:text-gray-400">
          {project.data.description}
        </p>

        <!-- View Details Link -->
        <div class="mt-auto flex items-center justify-between border-t border-gray-200 pt-4 dark:border-gray-700">
          <span class="text-xs font-medium text-gray-500 dark:text-gray-400">{project.data.category}</span>
          <span class="inline-flex items-center gap-1 text-xs font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300">
            {t('projects.viewDetails')}
            <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </span>
        </div>
      </div>
    ))}
  </div>
)}

<style>
  .project-card {
    animation: slideUp 0.3s ease-out;
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
