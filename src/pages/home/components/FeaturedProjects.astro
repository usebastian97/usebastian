---
import Button from '@components/ui/Button.astro';
import Card from '@components/cards/Card.astro';
import { useTranslations } from '@i18n/utils';
import { getCollection } from 'astro:content';

const t = useTranslations('en');

// Get featured projects
const allProjects = await getCollection('projects', ({ data }) => {
  return data.featured;
});
const featuredProjects = allProjects.sort((a, b) => a.data.order - b.data.order).slice(0, 3);
---

<section class="bg-white py-24">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="mb-12 text-center">
      <h2 class="mb-4">{t('home.featured_projects')}</h2>
      <p class="text-lg text-gray-600">
        M365, Power Platform, and Copilot governance initiatives that drive secure adoption
      </p>
    </div>

    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {
        // If there are no featured projects, show a friendly "coming soon" message
        featuredProjects.length === 0 ? (
          <div class="col-span-full flex items-center justify-center py-12">
            <div class="text-center max-w-2xl">
              <h3 class="mb-3 text-2xl font-semibold text-gray-900">New Projects Coming Soon</h3>
              <p class="text-gray-600 mb-6">
                I'm shaping new M365 and Power Platform projects focused on compliance and Copilot
                readiness.
              </p>
            </div>
          </div>
        ) : (
          featuredProjects.map((project) => (
            <Card
              title={project.data.title}
              description={project.data.description}
              href={`/projects/${project.slug}`}
              image={project.data.image ?? ''}
              tags={project.data.tags}
            />
          ))
        )
      }
    </div>

    <div class="mt-12 text-center">
      <Button href="/projects" variant="secondary"> View All Projects </Button>
    </div>
  </div>
</section>
