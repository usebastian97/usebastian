---
import MainLayout from '@layouts/MainLayout.astro';
import Card from '@components/cards/Card.astro';
import { useTranslations } from '@i18n/utils';
import { getCollection } from 'astro:content';

const t = useTranslations('en');

const allPosts = await getCollection('blog', ({ data }) => {
  return data.lang === 'en' && !data.draft;
});

const posts = allPosts.sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime()
);

const postsPerPage = 9;
const totalPages = Math.ceil(posts.length / postsPerPage);
---

<MainLayout title={`${t('blog.title')} | Sebastian Georgian Utoiu`}>
  <section class="bg-white py-20 dark:bg-black">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h1 class="mb-6 text-4xl font-bold tracking-tight sm:text-5xl">{t('blog.title')}</h1>
      <p class="mb-12 max-w-3xl text-xl text-gray-600 dark:text-gray-400">
        Insights on cloud architecture, AI, DevOps, and modern software development practices.
      </p>

      <!-- Posts Grid -->
      <div class="mb-12 grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {
          posts.slice(0, postsPerPage).map((post) => (
            <Card
              title={post.data.title}
              description={post.data.description}
              href={`/blog/${post.slug}`}
              image={post.data.image ?? ''}
              tags={post.data.tags}
              date={post.data.publishDate}
            />
          ))
        }
      </div>
      
      <!-- Pagination would go here for multiple pages -->
      {
        totalPages > 1 && (
          <div class="flex justify-center gap-2">
            {Array.from({ length: totalPages }, (_, i) => (
              <a
                href={i === 0 ? '/blog' : `/blog/${i + 1}`}
                class="rounded-lg border border-gray-300 px-4 py-2 transition-colors hover:border-blue-600 hover:text-blue-600 dark:border-gray-700"
              >
                {i + 1}
              </a>
            ))}
          </div>
        )
      }
    </div>
  </section>
</MainLayout>
