---
interface Props {
  title: string;
  description: string;
  href: string;
  image?: string;
  tags?: string[];
  date?: Date;
}

const { title, description, href, image, tags = [], date } = Astro.props;

// Function to get tag color based on tag name
const getTagColor = (tag: string) => {
  const tagLower = tag.toLowerCase();

  // Cloud/Infrastructure tags - Blue
  if (
    tagLower.includes('cloud') ||
    tagLower.includes('azure') ||
    tagLower.includes('aws') ||
    tagLower.includes('gcp')
  ) {
    return 'bg-blue-50 text-blue-600';
  }
  // AI/ML tags - Purple
  if (tagLower.includes('ai') || tagLower.includes('ml') || tagLower.includes('machine learning')) {
    return 'bg-purple-50 text-purple-600';
  }
  // DevOps/CI/CD tags - Green
  if (
    tagLower.includes('devops') ||
    tagLower.includes('ci/cd') ||
    tagLower.includes('automation') ||
    tagLower.includes('terraform')
  ) {
    return 'bg-green-50 text-green-600';
  }
  // Security tags - Red
  if (tagLower.includes('security') || tagLower.includes('kubernetes')) {
    return 'bg-red-50 text-red-600';
  }
  // Architecture/Design tags - Orange
  if (
    tagLower.includes('architecture') ||
    tagLower.includes('design') ||
    tagLower.includes('scalability')
  ) {
    return 'bg-orange-50 text-orange-600';
  }
  // Default - Gray
  return 'bg-gray-50 text-gray-600';
};
---

<article
  class="group relative flex flex-col rounded-lg border-4 border-gray-200 bg-white p-6 shadow-sm transition-all duration-200 hover:shadow-lg"
>
  {
    image && (
      <div class="-mx-6 -mt-6 mb-4 overflow-hidden rounded-t-md">
        <img
          src={image}
          alt={title}
          class="aspect-video w-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
        />
      </div>
    )
  }

  <!-- Tags Section -->
  {
    tags.length > 0 && (
      <div class="mb-3 flex flex-wrap gap-2">
        {tags.slice(0, 3).map((tag) => (
          <span class={`rounded-full px-3 py-1 text-xs font-semibold ${getTagColor(tag)}`}>
            {tag}
          </span>
        ))}
      </div>
    )
  }

  <!-- Title -->
  <h3 class="mb-3 text-lg font-bold text-gray-900">
    <a
      href={href}
      class="transition-colors after:absolute after:inset-0 hover:text-blue-600"
      aria-label={title}
    >
      {title}
    </a>
  </h3>

  <!-- Description -->
  <p class="mb-4 flex-grow text-sm leading-relaxed text-gray-600">
    {description}
  </p>

  <!-- Date & Read More -->
  {
    date && (
      <div class="mt-auto flex items-center justify-between border-t border-gray-200 pt-4">
        <time class="text-xs font-medium text-gray-500">
          {new Intl.DateTimeFormat('en', {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
          }).format(date)}
        </time>
        <span class="inline-flex items-center gap-1 text-xs font-medium text-blue-600 hover:text-blue-700">
          Read more
          <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5l7 7-7 7"
            />
          </svg>
        </span>
      </div>
    )
  }
</article>
